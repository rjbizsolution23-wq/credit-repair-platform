<div class="forgot-password-container">
  <div class="forgot-password-card">
    <!-- Header -->
    <div class="forgot-password-header">
      <div class="logo">
        <i class="fas fa-shield-alt"></i>
        <h1>CreditRepair Pro</h1>
      </div>
      
      <!-- Success State Header -->
      <div *ngIf="emailSent" class="success-header">
        <div class="success-icon">
          <i class="fas fa-envelope-circle-check"></i>
        </div>
        <h2>Check Your Email</h2>
        <p>We've sent password reset instructions to your email address.</p>
      </div>
      
      <!-- Default State Header -->
      <div *ngIf="!emailSent" class="default-header">
        <h2>Forgot Password?</h2>
        <p>Enter your email address and we'll send you instructions to reset your password.</p>
      </div>
    </div>

    <!-- Error Alert -->
    <div class="alert alert-danger" *ngIf="errorMessage" role="alert">
      <i class="fas fa-exclamation-circle"></i>
      <span>{{ errorMessage }}</span>
      <button type="button" class="btn-close" (click)="dismissError()" [disabled]="isLoading">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <!-- Success Alert -->
    <div class="alert alert-success" *ngIf="successMessage" role="alert">
      <i class="fas fa-check-circle"></i>
      <span>{{ successMessage }}</span>
      <button type="button" class="btn-close" (click)="dismissSuccess()" [disabled]="isLoading">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <!-- Email Sent Success State -->
    <div *ngIf="emailSent" class="email-sent-content">
      <div class="email-info">
        <div class="email-display">
          <i class="fas fa-envelope"></i>
          <span>{{ email?.value }}</span>
        </div>
        <p class="instructions">
          If an account with this email exists, you'll receive password reset instructions within a few minutes.
        </p>
      </div>

      <div class="email-actions">
        <button
          type="button"
          class="btn btn-primary btn-resend"
          (click)="resendEmail()"
          [disabled]="isLoading"
        >
          <span class="spinner-border" *ngIf="isLoading" role="status" aria-hidden="true"></span>
          <i class="fas fa-paper-plane" *ngIf="!isLoading"></i>
          <span *ngIf="!isLoading">Resend Email</span>
          <span *ngIf="isLoading">Sending...</span>
        </button>

        <button
          type="button"
          class="btn btn-outline-secondary btn-try-again"
          (click)="resetForm()"
          [disabled]="isLoading"
        >
          <i class="fas fa-arrow-left"></i>
          Try Different Email
        </button>
      </div>
    </div>

    <!-- Forgot Password Form -->
    <form 
      *ngIf="!emailSent" 
      [formGroup]="forgotPasswordForm" 
      (ngSubmit)="onSubmit()" 
      class="forgot-password-form" 
      novalidate
    >
      <!-- Email Field -->
      <div class="form-group">
        <label for="email" class="form-label">
          <i class="fas fa-envelope"></i>
          Email Address
        </label>
        <input
          type="email"
          id="email"
          formControlName="email"
          class="form-control"
          [class.is-invalid]="isFieldInvalid('email')"
          [class.is-valid]="isFieldValid('email')"
          placeholder="Enter your email address"
          [disabled]="isLoading"
          autocomplete="email"
          autofocus
        >
        <div class="invalid-feedback" *ngIf="isFieldInvalid('email')">
          {{ getFieldErrorMessage('email') }}
        </div>
      </div>

      <!-- Submit Button -->
      <button
        type="submit"
        class="btn btn-primary btn-reset"
        [disabled]="forgotPasswordForm.invalid || isLoading"
      >
        <span class="spinner-border" *ngIf="isLoading" role="status" aria-hidden="true"></span>
        <i class="fas fa-paper-plane" *ngIf="!isLoading"></i>
        <span *ngIf="!isLoading">Send Reset Instructions</span>
        <span *ngIf="isLoading">Sending...</span>
      </button>
    </form>

    <!-- Navigation Links -->
    <div class="navigation-links">
      <div class="back-to-login">
        <button
          type="button"
          class="link-button"
          (click)="navigateToLogin()"
          [disabled]="isLoading"
        >
          <i class="fas fa-arrow-left"></i>
          Back to Sign In
        </button>
      </div>

      <div class="register-link" *ngIf="!emailSent">
        <p>
          Don't have an account?
          <button
            type="button"
            class="link-button"
            (click)="navigateToRegister()"
            [disabled]="isLoading"
          >
            Create one here
          </button>
        </p>
      </div>
    </div>

    <!-- Help Section -->
    <div class="help-section" *ngIf="emailSent">
      <div class="help-content">
        <h4>Didn't receive the email?</h4>
        <ul>
          <li>Check your spam or junk folder</li>
          <li>Make sure you entered the correct email address</li>
          <li>Wait a few minutes for the email to arrive</li>
          <li>Contact support if you continue having issues</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="forgot-password-footer">
    <p>&copy; 2024 CreditRepair Pro. All rights reserved.</p>
    <div class="footer-links">
      <a href="/support" class="footer-link">Support</a>
      <a href="/privacy" class="footer-link">Privacy Policy</a>
      <a href="/terms" class="footer-link">Terms of Service</a>
    </div>
  </div>
</div>